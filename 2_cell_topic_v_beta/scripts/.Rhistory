#########################################################
################################ set up 
args_home ="/home/BCCRC.CA/ssubedi/projects/experiments/spruce_topic/2_cell_topic_v_beta/"
# args_home ="/home/sishirsubedi/projects/experiments/spruce_topic/2_cell_topic_v_beta/"
setwd(paste(args_home,'scripts/',sep=''))
library(yaml)
config = paste(args_home,"config.yaml",sep="") 
args = read_yaml(config)
ct_model_id = paste(args_home,args$cell_topic$out,args$cell_topic$model_id,sep='')
it_model_id = paste(args_home,args$interaction_topic$out,args$interaction_topic$model_id,sep='')
ct_id = paste(args_home,args$cell_topic$out,args$cell_topic$id,sep='')
it_id = paste(args_home,args$interaction_topic$out,args$interaction_topic$id,sep='')
file = paste(it_id,"8_chorddata.csv.gz",sep="")
df = read.table(file, sep = ",", header=TRUE)
df = df[order(df$topic),]
library("circlize")
f = paste(it_id,"8_chorddata.pdf",sep="")
pdf(f)
# df[,c(1,3,4)]
genes<- as.character(df[[2]])
othercol = structure(rep("grey", length(genes)), names = genes)
grid_col = c("2" = "#b3446c", "4" = "#dcd300", "7" = "#882d17",
"10"="#8db600","18"="#654522","22"="#e25822","24"="#2b3d26", othercol )
chordDiagram(df)
dev.off()
circos.clear()
